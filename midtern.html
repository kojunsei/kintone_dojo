<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="./midtern.css">
<title>dojo課題</title>

<style>
  html, body {
    height: 100%;
    margin: 0;
  }
  header {
    background-color: #1aaedb;
    border-bottom: #ead963 6px solid;
  }
  .container {
    padding: 16px;
    padding-left: 120px;
  }
  header h1,
  header h2 {
    margin: 0;
    color: #fff;
    line-height: 1;
  }
  header h1 {
    padding: 30px 0 5px 0;
    font-size: 24px;
    border-bottom: 1px dotted #fff;
    font-weight: 500;
  }
  header h2 {
    padding: 6px 0 0 0;
    font-size: 14px;
    font-weight: 400;
  }
</style>
</head>
<body>
<header>
<header>
  <div class="container">
    <h1>kintone dojo</h1>
    <h2>中間課題</h2>
    <h3  id="title" >「⾃社のHPで、APIで取得したデータを元に、
最新情報を表⽰するようなサイトを作りたい」</h3>

  </div>
</header>


<main class="container">
  <table border='3' align="center" id="table">
  </table>

</main>
<script src="https://js.cybozu.com/axios/v0.27.2/axios.min.js"></script>
<script>
'use strict';

axios.get('https://54o76ppvn8.execute-api.ap-northeast-1.amazonaws.com/prod/bb-dojo', {
  params: {
    id: 'dojo'
  }
}).then((resp) => {
// respからデータもらう
  const dojo = resp.data;
  const table = document.getElementById('table');

  console.log(dojo);
  // 増減できる表の一覧形式
  Object.keys(dojo).forEach((val) => {
    console.log(val);
    const cell_day = dojo[val].day.value;
    const cell_category = dojo[val].category.value;
    const cell_content = dojo[val].content.value;
    console.log(cell_day);

    const row = table.insertRow();

    const cell1 = row.insertCell(0);
    cell1.textContent = cell_day;
    const cell2 = row.insertCell(1);
    cell2.textContent = cell_category;
    console.log(cell_category);
    // カテゴリーごとに色分け
    if (cell_category === '企業情報') {
      cell2.classList.add('cell');
    } else if (cell_category === 'IR 情報') {
      cell2.classList.add('cell_IR');
    } else if (cell_category === '製品') {
      cell2.classList.add('cell_pro');
    }
    const cell3 = row.insertCell(2);
    cell3.textContent = cell_content;

    // リンク先のURLに遷移
    const cell_target = dojo[val].target.value;
    const link = dojo[val].url.value;
    cell3.setAttribute('href', link);
    cell3.setAttribute('target', cell_target);
    cell3.addEventListener('click', function() {
      if (cell_target === '_blank') {
        window.open(link, '_blank');
      } else if (cell_target === '_self') {
        window.location.href = link;
      }
    });
  });
}

).catch((err) => {
  console.log(`ADRESS GET ERROR : ${err}`);
});
  

</script>
</body>
</html>